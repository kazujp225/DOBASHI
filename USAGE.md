# 📚 使い方ガイド

## 🚀 初めての方へ

### 1. インストール

```bash
# リポジトリに移動
cd DOBASHIYOUTUBE

# 依存パッケージをインストール
pip install -r requirements.txt
```

### 2. アプリケーション起動

```bash
streamlit run app.py
```

ブラウザが自動的に開き、`http://localhost:8501` でアプリケーションが起動します。

---

## 📖 各ページの使い方

### 1. 📊 ダッシュボード

**目的**: 分析済みの動画データを一覧表示

**使い方**:
1. サイドバーから「📊 ダッシュボード」を選択
2. 分析済み動画がある場合、カード形式で表示されます
3. 各動画の展開ボタンをクリックすると詳細が表示されます

**表示内容**:
- 総コメント数
- 社長言及コメント数
- 言及率
- 社長別ランキング

---

### 2. 🔍 動画分析（デモモード）

**目的**: APIキーなしでシステムをテスト

**使い方**:

#### Step 1: サンプルコメント入力
```
林社長すごい!
岩井社長と林社長の対決が面白い
あすかさんのアドバイスが的確
面白かった
FC林と佐々木社長の掛け合いが最高
```

1行につき1コメントを入力してください。

#### Step 2: 出演社長選択
- チェックボックスで、この動画に出演している社長を選択
- 最大5名まで選択可能（実際の番組に合わせて）

#### Step 3: 分析実行
「🔍 分析実行」ボタンをクリック

#### 結果の見方

**サマリーセクション**:
- **総コメント数**: 入力したコメントの総数
- **社長言及コメント数**: 誰かしらの社長に言及しているコメント数
- **言及率**: 言及コメント数 ÷ 総コメント数

**社長別統計テーブル**:
| 順位 | 社長 | 言及数 | Rate_total (%) | Rate_entity (%) |
|------|------|--------|----------------|-----------------|
| 1 | 林社長 | 3 | 50.00 | 60.00 |

- **言及数**: この社長に言及しているコメント数
- **Rate_total**: 全コメントに対する割合（絶対的存在感）
- **Rate_entity**: 社長言及コメントに対する割合（相対的主役度）

**グラフ**:
1. **横棒グラフ（Rate_total）**: 動画全体での存在感
2. **横棒グラフ（Rate_entity）**: 社長の中での主役度
3. **円グラフ**: 言及数の分布

**コメント詳細**:
- 各コメントの展開ボタンをクリック
- 正規化されたテキストと検出された社長を確認

---

### 3. 📥 データ収集

**目的**: 実際のYouTube動画からコメントを収集

**前提条件**:
- YouTube Data API v3のAPIキーが必要
- APIキーの取得方法はREADME.mdを参照

**使い方**:

#### Step 1: APIキー入力
1. 「YouTube API キー」欄にAPIキーを入力
2. セキュリティのため、入力内容は隠されます

#### Step 2: 動画ID入力
動画URLから動画IDを取得:
```
YouTube URL: https://www.youtube.com/watch?v=dQw4w9WgXcQ
動画ID: dQw4w9WgXcQ
```

#### Step 3: コメント数設定
- スライダーで取得するコメント数を設定（10〜1000件）
- 初回は100件程度がおすすめ

#### Step 4: 収集実行
「📥 コメント収集」ボタンをクリック

**収集中の表示**:
- 動画情報取得中...
- コメント取得中...
- ✅ 収集完了メッセージ

**収集後**:
- データは `data/cache/` に自動保存
- ファイル名: `collected_{動画ID}_{タイムスタンプ}.json`

**注意事項**:
- YouTube APIは1日10,000 unitsまで
- コメント取得は約1 unit/リクエスト
- 大量取得時はクォータに注意

---

### 4. 👥 社長マスタ

**目的**: 登録されている社長情報の確認

**表示内容**:
- 社長ID
- 表示名
- 本名
- 説明
- 登録されている呼称（エイリアス）

**社長の追加方法**:

1. `data/tigers.json` を開く
2. 以下の形式で追加:

```json
{
  "tiger_id": "new_tiger",
  "display_name": "新社長",
  "full_name": "新 太郎",
  "description": "新規追加の社長",
  "image_url": ""
}
```

3. `data/aliases.json` を開く
4. 呼称を追加:

```json
"new_tiger": [
  {"alias": "新社長", "type": "formal", "priority": 1},
  {"alias": "新さん", "type": "casual", "priority": 2},
  {"alias": "新ちゃん", "type": "nickname", "priority": 3}
]
```

5. アプリケーションを再起動

---

## 🎯 実践例

### 例1: 特定動画の人気社長を知りたい

1. 「📥 データ収集」で動画のコメントを収集
2. 収集したJSONファイルを確認（`data/cache/collected_*.json`）
3. 「🔍 動画分析」で分析（※現在はデモモードのみ対応）
4. Rate_totalが高い社長 = その動画で注目された社長

### 例2: 新しい社長の呼称を追加

視聴者が「林さん」「はやし社長」など様々な呼び方をする場合:

1. `data/aliases.json` を開く
2. `hayashi` の配列に追加:
```json
{"alias": "はやし社長", "type": "variation", "priority": 4}
```
3. アプリを再起動して反映

### 例3: 複数動画を比較

1. 動画A、動画Bのコメントをそれぞれ収集
2. 各動画で分析を実行
3. Rate_totalやRate_entityを比較
4. 動画の内容や企画による人気の違いを把握

---

## 💡 Tips

### 精度を上げるコツ

1. **エイリアスを充実させる**
   - 視聴者が使う呼び方をすべて登録
   - 優先度を適切に設定（一般的な呼び方ほど優先度を高く）

2. **出演社長を正確に設定**
   - その動画に実際に出演している社長のみ選択
   - 関係ない社長を含めると精度が下がる

3. **サンプル数を増やす**
   - コメント数が多いほど統計的に信頼性が高まる
   - 最低100件以上を推奨

### よくある質問

**Q: 「Rate_totalとRate_entity、どちらを重視すべき？」**

A: 目的によります
- **Rate_total**: 動画全体での注目度を知りたい場合
- **Rate_entity**: 社長同士の相対的な人気を知りたい場合

**Q: 「言及されなかった社長は失敗？」**

A: いいえ、必ずしもそうではありません
- 投資判定が厳しかった場合など、必ずしも言及=人気とは限らない
- センチメント分析（ポジティブ・ネガティブ）は今後の機能追加予定

**Q: 「複数の社長に言及したコメントはどうカウントされる？」**

A: それぞれの社長に1件ずつカウントされます
- 例: 「林社長と岩井社長が面白い」→ 林社長1件、岩井社長1件

---

## 🔧 トラブルシューティング

### エラー: "ModuleNotFoundError"
```bash
# 依存パッケージを再インストール
pip install -r requirements.txt --upgrade
```

### エラー: "YouTube API Error: 403"
→ APIキーが無効、またはYouTube Data API v3が有効化されていません
1. [Google Cloud Console](https://console.cloud.google.com/)を確認
2. YouTube Data API v3が有効か確認
3. APIキーが正しいか確認

### グラフが表示されない
```bash
# Plotlyを再インストール
pip install plotly --upgrade
```

### ブラウザが自動で開かない
手動でブラウザを開き、以下のURLにアクセス:
```
http://localhost:8501
```

---

## 📞 サポート

問題が解決しない場合:
1. README.mdを確認
2. GitHubでIssueを作成
3. エラーメッセージとスクリーンショットを添付

---

**最終更新**: 2025-11-13
